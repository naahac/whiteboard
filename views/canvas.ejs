<!DOCTYPE html>
<html lang="en" style="height: 100%">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel='stylesheet' href='/stylesheets/style.css'/>
    <link rel="/javascripts/widget.html"></link>
</head>
<body style="height: 100%">
<div id="widget-container" style="height: 100%"></div>
<script src="/socket.io/socket.io.js"></script>
<script src="/javascripts/canvas-designer-widget.js"></script>
<script>
    function getParameterByName(name, url) {
        if (!url) {
            url = window.location.href;
        }
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    var socket = io();
    var designer = new CanvasDesigner();
    designer.widgetHtmlURL = '/javascripts/widget.html';
    designer.widgetJsURL = '/javascripts/widget.js';
    <!-- 3rd i.e. last step -->
    // <iframe> will be appended to "document.body"
    //        designer.appendTo(document.body || document.documentElement);
    //        if (!designer.iframe) {
    //            designer.appendTo(document.body);
    //        }
    designer.appendTo(document.getElementById('widget-container'));
    if (!designer.iframe) {
        designer.appendTo(document.body);
    }
    designer.iframe.style.height = '100%'
    designer.addSyncListener(function (data) {
        console.log("syncing");
        socket.emit('syncCanvas', getParameterByName('canvasId'), data);
    });
    socket.on('syncCanvas', function (data) {
        if(typeof data !== 'object')
            designer.syncData(JSON.parse(data));
        else
            designer.syncData(data);
    });
    if(designer.pointsLength <= 0) {
        setTimeout(function() {
            socket.emit('addSocketToCanvas',getParameterByName('canvasId'));
        }, 1000);
    }
</script>
</body>
</html>
